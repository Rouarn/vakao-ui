import{p as T,h,x as k,q}from"./framework.CJ-qkA9M.js";function B(t=!1){const n=T(t),r=h(()=>n.value);function u(){n.value=!n.value}function l(){n.value=!0}function e(){n.value=!1}return[r,u,l,e]}function F(t=0,n={}){const{min:r,max:u}=n,l=T(t),e=h(()=>l.value);function a(d=1){const o=l.value+d;l.value=u!==void 0?Math.min(o,u):o}function i(d=1){const o=l.value-d;l.value=r!==void 0?Math.max(o,r):o}function m(){l.value=t}function f(d){let o=d;r!==void 0&&(o=Math.max(o,r)),u!==void 0&&(o=Math.min(o,u)),l.value=o}return[e,a,i,m,f]}const U={read:t=>{try{return JSON.parse(t)}catch{return t}},write:t=>JSON.stringify(t)};function G(t,n,r={}){const{serializer:u=U,syncAcrossTabs:l=!0}=r,e=`vk-${t}`;function a(){if(typeof window>"u")return n;try{const c=window.localStorage.getItem(e);return c===null?n:u.read(c)}catch(c){return console.warn(`Error reading localStorage key "${e}":`,c),n}}function i(c){if(!(typeof window>"u"))try{window.localStorage.setItem(e,u.write(c))}catch(s){console.warn(`Error setting localStorage key "${e}":`,s)}}function m(){if(!(typeof window>"u"))try{window.localStorage.removeItem(e)}catch(c){console.warn(`Error removing localStorage key "${e}":`,c)}}const f=T(a()),d=h(()=>f.value);function o(c){const s=typeof c=="function"?c(f.value):c;f.value=s,i(s)}function v(){f.value=n,m()}if(q(f,c=>{i(c)},{deep:!0}),typeof window<"u"&&l){const c=s=>{if(s.key===e&&s.newValue!==null)try{f.value=u.read(s.newValue)}catch($){console.warn(`Error parsing storage event for key "${e}":`,$)}else s.key===e&&s.newValue===null&&(f.value=n)};if(window.addEventListener("storage",c),typeof window<"u"){const s=()=>{window.removeEventListener("storage",c)};o.cleanup=s}}return[d,o,v]}function H(t,n,r={}){return typeof t=="object"&&"value"in t?V(t,n):z(t,n,r)}function V(t,n){const r=T(t.value);let u=null;const l=h(()=>r.value),e=()=>{r.value=t.value};return q(t,()=>{u!==null&&clearTimeout(u),u=setTimeout(e,n)},{immediate:!1}),k(()=>{u!==null&&clearTimeout(u)}),l}function z(t,n,r={}){const{leading:u=!1,trailing:l=!0}=r;let e=null,a=null,i=null;const m=()=>{e!==null&&(clearTimeout(e),e=null),a=null,i=null},f=()=>{e!==null&&a!==null&&(m(),t(...a))},d=(...o)=>{const v=Date.now();a=o,u&&(i===null||v-i>=n)&&(i=v,t(...o)),e!==null&&clearTimeout(e),l&&(e=setTimeout(()=>{(!u||i!==null&&v-i>=n)&&t(...o),i=Date.now(),e=null},n))};return k(()=>{m()}),[d,m,f]}function K(t,n,r={}){return typeof t=="object"&&"value"in t?C(t,n):J(t,n,r)}function C(t,n){const r=T(t.value);let u=0,l=null;const e=h(()=>r.value),a=()=>{r.value=t.value,u=Date.now()};return q(t,()=>{const i=Date.now()-u;i>=n?a():(l!==null&&clearTimeout(l),l=setTimeout(()=>{a(),l=null},n-i))},{immediate:!1}),k(()=>{l!==null&&clearTimeout(l)}),e}function J(t,n,r={}){const{leading:u=!0,trailing:l=!0}=r;let e=0,a=null,i=null;const m=()=>{a!==null&&(clearTimeout(a),a=null),i=null},f=()=>{a!==null&&i!==null&&(m(),t(...i),e=Date.now())},d=(...o)=>{const v=Date.now();i=o;const c=v-e;if(e===0&&u){t(...o),e=v;return}c>=n?u?(t(...o),e=v):l&&(a!==null&&clearTimeout(a),a=setTimeout(()=>{t(...o),e=Date.now(),a=null},n)):l&&(a!==null&&clearTimeout(a),a=setTimeout(()=>{t(...o),e=Date.now(),a=null},n-c))};return k(()=>{m()}),[d,m,f]}function Q(t,n={},r={}){const{immediate:u=!0,timeout:l=1e4,retries:e=0,retryDelay:a=1e3,transform:i,beforeRequest:m,afterRequest:f,onError:d}=n,o=T(null),v=T(!1),c=T(null),s=T("idle"),$=h(()=>o.value),R=h(()=>s.value==="success"||s.value==="error");let g=null,P=0;const M=()=>{if(typeof t=="function")try{return t()instanceof Promise}catch{return!1}return!1},A=()=>typeof t=="function"&&!M()?t():t,S=(b,w)=>({message:b,status:w==null?void 0:w.status,statusText:w==null?void 0:w.statusText,url:A()}),N=b=>new Promise(w=>setTimeout(w,b)),j=async()=>{g&&g.abort(),g=new AbortController,v.value=!0,c.value=null,s.value="loading",P=0;const b=async()=>{try{if(M()){const w=t,x=new Promise((p,E)=>{setTimeout(()=>{E(S("Request timeout"))},l)}),D=await Promise.race([w(),x]);let y=D;i&&(y=i(D)),o.value=y,s.value="success",v.value=!1}else{const w=A();m&&await m(w,r);const x={...r,signal:g==null?void 0:g.signal},D=setTimeout(()=>{g&&g.abort()},l);try{const y=await fetch(w,x);if(clearTimeout(D),f&&await f(y),!y.ok)throw S(`HTTP Error: ${y.status} ${y.statusText}`,y);let p;const E=y.headers.get("content-type");E!=null&&E.includes("application/json")?p=await y.json():E!=null&&E.includes("text/")?p=await y.text():p=await y.blob(),i&&(p=i(p)),o.value=p,s.value="success",v.value=!1}catch(y){throw clearTimeout(D),y}}}catch(w){if(w.name==="AbortError")return;const x=w instanceof Error?S(w.message):S("Unknown error occurred");if(P<e)return P++,await N(a),b();c.value=x,s.value="error",v.value=!1,d&&d(x)}};await b()},I=()=>{g&&(g.abort(),g=null),v.value=!1,s.value="idle"},O=async()=>{await j()};return u&&j(),k(()=>{I()}),[$,v,c,{status:s,finished:R,execute:j,cancel:I,refresh:O}]}export{F as B,Q as G,B as K,G as O,H as Q,K as W};
